<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<opt:optionLanguage xmlns:opt="http://crownking/opt"
                    opt:id="ClangGlobal"
                    opt:name="Clang Language Toolchain"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xsi:schemaLocation="http://crownking/opt opt/optionLanguage.xsd">

    <opt:optionCategory opt:id="general" opt:name="General">
        <opt:booleanOption opt:id="legacy-libc" opt:groupid="both" opt:name="Use Legacy libc" opt:booldefault="${legacy-libc.default}" opt:suppressif="${pic32C.selected}"/>
        <opt:booleanOption opt:id="save-temps"  opt:groupid="both" opt:name="Don't delete intermediate files" opt:trueemission="-save-temps=obj" opt:booldefault="false">
            <opt:xhtml>Don't delete intermediate files. Place them in the object directory and name them based on the source file.</opt:xhtml>
        </opt:booleanOption>
        <opt:booleanOption opt:id="wpo-lto" opt:groupid="wpo" opt:name="Use Whole-Program and Link-Time Optimizations" opt:trueemission="">
            <opt:xhtml>When this feature is enabled, the build will be constrained in the following ways:
                <br/> - The per-file build settings will be ignored;
                <br/> - The build will no longer be an incremental one (full build only).
            </opt:xhtml>
        </opt:booleanOption>
        <opt:stringOption opt:groupid="gp-relative-treshhold" opt:id="gp-relative-option" opt:name="Use GP relative addressing threshold" opt:emissionprefix="-G " opt:validatorclass="com.microchip.mplab.nbide.toolchainCommon.opt.validation.DecimalNumberOptionValidator" opt:suppressif="${pic32C.selected}">
            <opt:xhtml>Put definitions of externally-visible data in a small data section if that data is no bigger than num bytes.</opt:xhtml>
        </opt:stringOption>
        <opt:booleanOption    opt:name="Relaxed floating-point math"   opt:trueemission="-relaxed-math"  opt:booldefault="false" opt:groupid="both" opt:id="relaxed-math" opt:suppressif="${pic32C.selected}">
        <opt:version opt:fromversion="1.32"/>
        </opt:booleanOption>    
        <opt:stringListOption opt:name="Common include dirs"               opt:emissionprefix="-I"     opt:emissionseparator=" -I"                                                        opt:groupid="common-include-dirs" opt:id="common-include-directories" opt:slashnormalization="unix" opt:isdirectory="true" opt:isbrowsable="true">
            <opt:browseinfo>
                Relative paths are from
                <br/>MPLAB X project directory.
            </opt:browseinfo>
            <opt:xhtml>Add 'dir' to the list of shared include directories for compilers and assembler.
                <br/>
                <br/>Relative paths are from MPLAB X project directory.
            </opt:xhtml>
        </opt:stringListOption>
        <opt:stringOption opt:groupid="both" opt:id="mdtcm" opt:name="Data TCM size in bytes" opt:emissionprefix="-mdtcm=" opt:validatorclass="com.microchip.mplab.nbide.toolchainCommon.opt.validation.CSyntaxNumberValidator" opt:unsuppressif="${pic32C.selected}" opt:showif="${pic32C.selected}">
            <opt:version opt:fromversion="1.95"/>
            <opt:xhtml>Enable data Tightly Coupled Memory with the specified size.</opt:xhtml>
        </opt:stringOption>
        <opt:stringOption opt:groupid="both" opt:id="mitcm" opt:name="Instruction TCM size in bytes" opt:emissionprefix="-mitcm=" opt:validatorclass="com.microchip.mplab.nbide.toolchainCommon.opt.validation.CSyntaxNumberValidator" opt:unsuppressif="${pic32C.selected}" opt:showif="${pic32C.selected}">
            <opt:version opt:fromversion="1.95"/>
            <opt:xhtml>Enable instruction Tightly Coupled Memory with the specified size.</opt:xhtml>
        </opt:stringOption>
        <opt:booleanOption    opt:name="Locate Stack in data TCM"   opt:trueemission="-mstack-in-tcm"  opt:booldefault="false" opt:groupid="both" opt:id="mstacktcm" opt:unsuppressif="${pic32C.selected}" opt:showif="${pic32C.selected}">
            <opt:version opt:fromversion="1.95"/>
            <opt:xhtml>Locate the stack in data Tightly Coupled Memory.</opt:xhtml>
        </opt:booleanOption>
    </opt:optionCategory>
    <opt:optionCategory opt:id="target-options" opt:name="Target Specific">
        <opt:booleanOption  opt:id="target-auto-detect" opt:name="Auto-detect target options" opt:booldefault="true">
            <opt:trueModifiers>
            </opt:trueModifiers>
            <opt:falseModifiers>
            </opt:falseModifiers>
        </opt:booleanOption>
        <opt:enumOption opt:id="target.arch" opt:groupid="both" opt:name="Target Architecture" opt:textdefault="${target.arch.defualt}" opt:emissionprefix="-target " opt:emitswhendefault="true">
            <opt:selection opt:text="${target.arch.default}" opt:name="Auto-detect">
                <opt:enumOptionAssigner opt:idref="target.mips32.cpu" opt:text="${target.mips32.cpu.default}"/>
                <opt:optionSuppressor opt:idref="target.mips32.cpu" opt:bool="${target.arch.isARM}"/>
                <opt:enumOptionAssigner opt:idref="target.mips32.fpu" opt:text="${target.mips32.fpu.default}"/>
                <opt:optionSuppressor opt:idref="target.mips32.fpu" opt:bool="${target.arch.isARM}"/>
                <opt:enumOptionAssigner opt:idref="target.mips32.dsp" opt:text="${target.mips32.dsp.default}"/>
                <opt:optionSuppressor opt:idref="target.mips32.dsp" opt:bool="${target.arch.isARM}"/>
                <opt:enumOptionAssigner opt:idref="target.arm.cpu" opt:text="${target.arm.cpu.default}"/>
                <opt:optionSuppressor opt:idref="target.arm.cpu" opt:bool="${target.arch.isMIPS32}"/>
                <opt:enumOptionAssigner opt:idref="target.arm.fpu" opt:text="${target.arm.fpu.default}"/>
                <opt:optionSuppressor opt:idref="target.arm.fpu" opt:bool="${target.arch.isMIPS32}"/>
            </opt:selection>
            <opt:selection opt:text="mipsel-unknown-elf" opt:name="MIPS32 (mipsel-unknown-elf)">
                <opt:optionSuppressor opt:idref="target.mips32.cpu" opt:bool="false"/>
                <opt:optionSuppressor opt:idref="target.mips32.fpu" opt:bool="false"/>
                <opt:optionSuppressor opt:idref="target.mips32.dsp" opt:bool="false"/>
                <opt:optionSuppressor opt:idref="target.arm.cpu" opt:bool="true"/>
                <opt:optionSuppressor opt:idref="target.arm.fpu" opt:bool="true"/>
            </opt:selection>
            <opt:selection opt:text="arm-none-eabi" opt:name="ARM (arm-none-eabi)">
                <opt:optionSuppressor opt:idref="target.mips32.cpu" opt:bool="true"/>
                <opt:optionSuppressor opt:idref="target.mips32.fpu" opt:bool="true"/>
                <opt:optionSuppressor opt:idref="target.mips32.dsp" opt:bool="true"/>
                <opt:optionSuppressor opt:idref="target.arm.cpu" opt:bool="false"/>
                <opt:optionSuppressor opt:idref="target.arm.fpu" opt:bool="false"/>
            </opt:selection>
        </opt:enumOption>
        <opt:enumOption opt:id="target.mips32.cpu" opt:groupid="both" opt:name="MIPS CPU Type" opt:textdefault="${target.mips32.cpu.default}" opt:emissionprefix="" opt:emitswhendefault="true">
            <opt:selection opt:text="${target.mips32.cpu.default}" opt:name="Auto-detect"/>
            <opt:selection opt:text="-mips32r2" opt:name="MIPS32r2"/>
            <opt:selection opt:text="-mips32r5" opt:name="MIPS32r5"/>
        </opt:enumOption>
        <opt:enumOption opt:id="target.mips32.fpu" opt:groupid="both" opt:name="MIPS Floating-point" opt:textdefault="${target.mips32.fpu.default}" opt:emissionprefix="" opt:emitswhendefault="true">
            <!-- TODO:  Do I need to specify both of these floating-point options for MIPS? -->
            <opt:selection opt:text="${target.mips32.fpu.default}" opt:name="Auto-detect"/>
            <opt:selection opt:text="-msoft-float -mfloat-abi=soft" opt:name="Software"/>
            <opt:selection opt:text="-mhard-float -mfloat-abi=hard" opt:name="Hardware"/>
        </opt:enumOption>
        <opt:enumOption opt:id="target.mips32.dsp" opt:groupid="both" opt:name="MIPS DSP ASE" opt:textdefault="${target.mips32.dsp.default}" opt:emissionprefix="" opt:emitswhendefault="true">
            <opt:selection opt:text="${target.mips32.dsp.default}" opt:name="Auto-detect"/>
            <opt:selection opt:text="" opt:name="Unsupported"/>
            <opt:selection opt:text="-mdspr2" opt:name="Supported"/>
        </opt:enumOption>
        <opt:enumOption opt:id="target.arm.cpu" opt:groupid="both" opt:name="ARM CPU Type" opt:textdefault="${target.arm.cpu.default}" opt:emissionprefix="-mcpu=" opt:emitswhendefault="true">
            <opt:selection opt:text="${target.arm.cpu.default}" opt:name="Auto-detect"/>
            <opt:selection opt:text="cortex-m3" opt:name="Cortex M3"/>
            <opt:selection opt:text="cortex-m4" opt:name="Cortex M4"/>
            <opt:selection opt:text="cortex-m7" opt:name="Cortex M7"/>
            <opt:selection opt:text="cortex-a5" opt:name="Cortex A5"/>
        </opt:enumOption>
        <opt:enumOption opt:id="target.arm.fpu" opt:groupid="both" opt:name="ARM Floating-point" opt:textdefault="${target.arm.fpu.default}" opt:emissionprefix="-mfpu=" opt:emitswhendefault="true">
            <opt:selection opt:text="${target.arm.fpu.default}" opt:name="Auto-detect"/>
            <opt:selection opt:text="-msoft-float -mfloat-abi=soft" opt:name="Software"/>
            <opt:selection opt:text="-mfpu=vfp4-sp-d16 -mfloat-abi=hard" opt:name="VFPv4 (Single-precision only)"/>
            <opt:selection opt:text="-mfpu=vfp5-sp-d16 -mfloat-abi=hard" opt:name="VFPv5 (Single-precision only)"/>
            <opt:selection opt:text="-mfpu=vfp5-dp-d16 -mfloat-abi=hard" opt:name="VFPv5"/>
            <opt:selection opt:text="-mfpu=neon-vfpv4 -mfloat-abi=hard" opt:name="NEON"/>
        </opt:enumOption>

        <!-- TODO:  The following properties need to be added to ClangRuntimeProperties.java :
            target.arch.defualt
            target.mips32.cpu.default
            target.mips32.fpu.default
            target.mips32.dsp.default
            target.arm.cpu.default
            target.arm.fpu.default
            target.arch.isARM
            target.arch.isMIPS32
        -->
    </opt:optionCategory>
    
    <opt:enablePattern opt:idref="legacy-libc" opt:expr="(-legacy-libc)" />
    <opt:enablePattern opt:idref="save-temps"  opt:expr="-save-temps.*"/>
    <opt:enablePattern opt:idref="gp-relative-option" opt:expr="-G " />
    <opt:enablePattern opt:expr="-relaxed-math"   opt:idref="relaxed-math"/>
    <opt:submatchPattern opt:expr="-I(.+)" opt:firstexpr="-I" opt:secondexpr="(.+)" opt:idref="common-include-directories"/>
</opt:optionLanguage>
